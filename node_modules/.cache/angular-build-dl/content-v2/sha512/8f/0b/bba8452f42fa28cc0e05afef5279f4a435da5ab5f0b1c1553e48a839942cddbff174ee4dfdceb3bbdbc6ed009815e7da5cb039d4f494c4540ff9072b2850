!function(){function e(t,n){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,n)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,a=r(e);if(t){var o=r(this).constructor;i=Reflect.construct(a,arguments,o)}else i=a.apply(this,arguments);return n(this,i)}}function n(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}(self.webpackChunksmart=self.webpackChunksmart||[]).push([[5773],{85773:function(n,r,o){"use strict";o.r(r),o.d(r,{StudentScheduleModule:function(){return Ue}});var s=o(61116),u=o(31041),c=o(39199),d=o(5609),p=o(13070),m=o(9550),h=o(63589),f=o(84369),g=o(77307),v=o(13841),y=o(92935),b=o(59241),A=o(37112),Z=o(69024),S=o(40994),_=o(1325),N=o(57173),T=o(97070),w=o(87672),x=o(44716),D=o(51601),k=o(35729),q=o(81258),L=o(91681),U=o(99235),I=o(35366),C=o(97425),E=o(42693),P=o(89647),O=o(51816),F=o(529),J=function(){var e=function(){function e(t){a(this,e),this.http=t,this.API_URL="assets/data/calendar.json",this.httpOptions={headers:new E.WM({"Content-Type":"application/json"})},this.dataChange=new C.X([])}return l(e,[{key:"data",get:function(){return this.dataChange.value}},{key:"getDialogData",value:function(){return this.dialogData}},{key:"getAllCalendars",value:function(){return this.http.get(this.API_URL).pipe((0,O.K)(this.errorHandler))}},{key:"deleteCalendar",value:function(e){this.dialogData=e}},{key:"errorHandler",value:function(e){var t;return t=e.error instanceof ErrorEvent?e.error.message:"Error Code: ".concat(e.status,"\nMessage: ").concat(e.message),console.log(t),(0,P._)(t)}},{key:"getScheduleList",value:function(){return this.http.get("".concat(F.N.apiUrl,"/webRoutes/getScheduleList")).pipe((0,L.U)(function(e){return e}))}},{key:"setScheduleDetails",value:function(e,t,n){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/setScheduleDetails"),{calendarData:e,timeSlot:t,viewAssign_selected:n}).pipe((0,L.U)(function(e){return e}))}},{key:"getScheduleDetailsForStudent",value:function(e){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/getScheduleDetailsForStudent"),{statusid:e}).pipe((0,L.U)(function(e){return e}))}},{key:"updateScheduleDetails",value:function(e,t){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/updateScheduleDetails"),{calendarData:e,viewAssign_selected:t}).pipe((0,L.U)(function(e){return e}))}},{key:"deleteScheduleDetails",value:function(e){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/deleteScheduleDetails"),{calendarData:e}).pipe((0,L.U)(function(e){return e}))}},{key:"getTimeDetails",value:function(){return this.http.get("".concat(F.N.apiUrl,"/webRoutes/getTimeDetails")).pipe((0,L.U)(function(e){return e}))}},{key:"getSelectedScheduleInfoStudent",value:function(e,t){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/getSelectedScheduleInfoStudent"),{calendarInfo:e,enrollData:t}).pipe((0,L.U)(function(e){return e}))}},{key:"getNRICNumberForStudentSchedule",value:function(){return this.http.get("".concat(F.N.apiUrl,"/webRoutes/getNRICNumberForStudentSchedule")).pipe((0,L.U)(function(e){return e}))}},{key:"getPassportNumberForStudentSchedule",value:function(){return this.http.get("".concat(F.N.apiUrl,"/webRoutes/getPassportNumberForStudentSchedule")).pipe((0,L.U)(function(e){return e}))}},{key:"getEnrollmentNumberForSchedule",value:function(e){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/getEnrollmentNumberForSchedule"),{studentId:e}).pipe((0,L.U)(function(e){return e}))}},{key:"checkPaymentDone",value:function(e){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/checkPaymentDone"),{studentInfo:e}).pipe((0,L.U)(function(e){return e}))}},{key:"getStudentSchedulePerEnroll",value:function(e){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/getStudentSchedulePerEnroll"),{studentInfo:e}).pipe((0,L.U)(function(e){return e}))}},{key:"setStudentScheduleInfo",value:function(e,t,n){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/setStudentScheduleInfo"),{finalArray:e,enrollData:t,rangelist:n}).pipe((0,L.U)(function(e){return e}))}},{key:"setPaymentDetails",value:function(e,t){return this.http.post("".concat(F.N.apiUrl,"/webRoutes/setPaymentDetails"),{enrollValue:e,amountToBePaid:t}).pipe((0,L.U)(function(e){return e}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(I.LFG(E.eN))},e.\u0275prov=I.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),R=o(50518),Y=o(7436),Q=o(60649);function j(e,t){if(1&e&&(I.TgZ(0,"div",9),I.TgZ(1,"p"),I._uU(2),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(2),I.hij("",n.calendar.schedule_name," is Scheduled")}}function M(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"li",16),I.TgZ(1,"mat-radio-button",17),I.NdJ("change",function(e){var t=I.CHM(n).$implicit;return I.oxw(2).changeTimeDt(e,t)}),I._uU(2),I.qZA(),I.qZA()}if(2&e){var i=t.$implicit;I.xp6(1),I.Q6J("checked",i.checked)("disabled",i.disabled),I.xp6(1),I.hij(" ",i.range," ")}}function B(e,t){if(1&e&&(I.TgZ(0,"div",9),I.TgZ(1,"label"),I._uU(2,"Schedule Time"),I.qZA(),I.TgZ(3,"div",14),I.YNc(4,M,3,3,"li",15),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(4),I.Q6J("ngForOf",n.timeArray)}}function H(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"mat-radio-button",22),I.NdJ("change",function(e){I.CHM(n);var t=I.oxw(2).$implicit;return I.oxw(2).instructorChange(e,t)}),I._uU(1),I.qZA()}if(2&e){var i=t.$implicit;I.Q6J("value",i)("checked",i.checked),I.xp6(1),I.hij(" ",i.name," ")}}function z(e,t){if(1&e&&(I.TgZ(0,"mat-radio-group",20),I.YNc(1,H,2,3,"mat-radio-button",21),I.qZA()),2&e){var n=I.oxw().$implicit;I.xp6(1),I.Q6J("ngForOf",n.employeeList)}}function W(e,t){1&e&&(I.TgZ(0,"li"),I.TgZ(1,"span",23),I._uU(2," -- "),I.qZA(),I.qZA())}function $(e,t){if(1&e&&(I.TgZ(0,"ul",16),I.TgZ(1,"li"),I._uU(2),I.qZA(),I.YNc(3,z,2,1,"mat-radio-group",18),I.YNc(4,W,3,0,"li",19),I.qZA()),2&e){var n=t.$implicit;I.xp6(2),I.Oqu(n.range),I.xp6(1),I.Q6J("ngIf",n.employeeList.length>0),I.xp6(1),I.Q6J("ngIf",0==n.employeeList.length)}}function X(e,t){if(1&e&&(I.TgZ(0,"div",9),I.TgZ(1,"label"),I._uU(2,"Select Instructor"),I.qZA(),I.TgZ(3,"div",14),I.YNc(4,$,5,3,"ul",15),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(4),I.Q6J("ngForOf",n.timeArray)}}function G(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",9),I.TgZ(1,"div",24),I.TgZ(2,"div",25),I.TgZ(3,"button",26),I.NdJ("click",function(){return I.CHM(n),I.oxw().setStudentScheduleInfo()}),I._uU(4),I.ALo(5,"translate"),I.qZA(),I.TgZ(6,"button",27),I.NdJ("click",function(){return I.CHM(n),I.oxw().dialogRef.close()}),I._uU(7),I.ALo(8,"translate"),I.qZA(),I.qZA(),I.qZA(),I.qZA()}if(2&e){var i=I.oxw();I.xp6(3),I.Q6J("type",i.submit),I.xp6(1),I.Oqu(I.lcZ(5,3,"BUTTON.ADD-BTN")),I.xp6(3),I.Oqu(I.lcZ(8,5,"BUTTON.CANCEL-BTN"))}}var V=function(){var e=function(){function e(t,n,i,r,o){a(this,e),this.dialogRef=t,this.data=n,this.calendarService=i,this.fb=r,this.toastrService=o,this.showDeleteBtn=!1,this.selectable=!0,this.removable=!0,this.separatorKeysCodes=[U.K5,U.OC],this.finalArray=[],this.action=n.action,this.actionData=n.calendar,this.timeArray=n.timeData,this.getScheduleList()}return l(e,[{key:"ngOnInit",value:function(){var e=this;if("edit"===this.action){this.dialogTitle=this.actionData.title,this.calendar=this.actionData,console.log("data.calendar============",this.calendar),this.enrollData={schedule_view:this.actionData.schedule_view,studentId:this.actionData.enrollData.student_id,enrollId:this.actionData.enrollData.id,statusId:this.actionData.statusid,scheduleDate:this.actionData.startDate};var t=[];this.calendarService.getSelectedScheduleInfoStudent(this.actionData,this.enrollData).subscribe(function(n){console.log("1111---------------",n.existingSchedule);var i=n.scheduleList;if(t=n.existingSchedule,"All"==e.actionData.schedule_view){for(var r=0;r<i.length;r++)for(var a=0;a<e.timeArray.length;a++){var o=e.zeroPad(i[r].TimeSlot,e.timeArray.length);console.log("timeSlotDt====",o),1==o[a]?(e.timeArray[a].employeeList=[],e.timeArray[a].disabled=!1,e.timeArray[a].checked=!1):(e.timeArray[a].employeeList=[],e.timeArray[a].disabled=!0,e.timeArray[a].checked=!1)}if(t.length>0){e.finalArray=[];for(var l=0;l<t.length;l++)for(var s=0;s<e.timeArray.length;s++){var u=e.zeroPad(t[l].TimeSlot,e.timeArray.length);console.log("exists----timeslot-----",u),1==u[s]?(e.timeArray[s].employeeList=[],e.timeArray[s].checked=!0,e.finalArray.push(e.timeArray[s])):(e.timeArray[s].employeeList=[],e.timeArray[s].checked=!1),console.log("this.timeArray==111111111111==",e.timeArray,e.finalArray)}}}else{for(var c=0;c<i.length;c++)for(var d=0;d<e.timeArray.length;d++)e.timeArray[d].employeeList=[],1==e.zeroPad(i[c].TimeSlot,e.timeArray.length)[d]&&e.timeArray[d].employeeList.push({id:i[c].employee_id,name:i[c].employeeName,checked:!1});if(t.length>0){e.finalArray=[];for(var p=0;p<t.length;p++)for(var m=0;m<e.timeArray.length;m++){var h=e.zeroPad(t[p].TimeSlot,e.timeArray.length);if(console.log("exists----timeslot-----",h),1==h[m]&&e.timeArray[m].employeeList.length>0)for(var f=0;f<e.timeArray[m].employeeList.length;f++)if(e.timeArray[m].employeeList[f].id==t[p].employee_id){e.timeArray[m].employeeList[f].checked=!0;var g=e.timeArray[m];g.selected=e.timeArray[m].employeeList[f],e.finalArray.push(g),console.log("existing------",e.finalArray)}else e.timeArray[m].employeeList[f].checked=!1}}}}),this.calendarForm=this.editContactForm()}}},{key:"zeroPad",value:function(e,t){return e.toString().padStart(Number(t),"0")}},{key:"editContactForm",value:function(){return this.fb.group({id:[this.calendar.id],lead_time:[this.calendar.lead_time,[u.kI.required]],schedule_name:[this.calendar.schedule_name],schedule_view:[this.calendar.schedule_view],startDate:[this.calendar.startDate,[u.kI.required]],endDate:[this.calendar.endDate,[u.kI.required]]})}},{key:"submit",value:function(){}},{key:"onNoClick",value:function(){this.dialogRef.close()}},{key:"setStudentScheduleInfo",value:function(){var e=this;console.log("this.finalArray==========",this.finalArray);for(var t=[],n=0;n<this.finalArray.length;n++)if(t.push(this.finalArray[n].range),this.finalArray[n].timeSlot="","All"==this.actionData.schedule_view)for(var i=0;i<this.timeArray.length;i++)this.finalArray[n].timeSlot=this.finalArray[n].timeSlot+(this.finalArray[n].range==this.timeArray[i].range?1:0);else for(var r=0;r<this.timeArray.length;r++)this.finalArray[n].timeSlot=this.finalArray[n].timeSlot+(this.finalArray[n].range==this.timeArray[r].range?1:0);this.calendarService.setStudentScheduleInfo(this.finalArray,this.enrollData,t).subscribe(function(t){"Success"==t.status&&(e.toastrService.success("Scheduled Successfully!!"),e.dialogRef.close("submit"))})}},{key:"displayFn",value:function(e){return e&&e.name?e.name:""}},{key:"instructorChange",value:function(e,t){var n=this.timeArray.filter(function(e){return e.range==t.range})[0];console.log("event.value========",e.value),n.selected=e.value,this.finalArray.some(function(e){return e.range==t.range})||this.finalArray.push(n)}},{key:"changeTimeDt",value:function(e,t){console.log("---------",e,t);var n=this.timeArray.filter(function(e){return e.range==t.range})[0];console.log("event.value========",e),n.selected=e.value,this.finalArray=[],this.finalArray.some(function(e){return e.range==t.range})||this.finalArray.push(n),console.log("this.filteredTimeArray---change------",this.finalArray)}},{key:"getScheduleList",value:function(){var e=this;this.calendarService.getScheduleList().subscribe(function(t){e.scheduleList=t.data})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(I.Y36(y.so),I.Y36(y.WI),I.Y36(J),I.Y36(u.qu),I.Y36(R._W))},e.\u0275cmp=I.Xpm({type:e,selectors:[["app-form-dialog"]],decls:24,vars:9,consts:[[1,"addContainer"],[1,"modalHeader"],[1,"editRowModal"],[1,"modalHeader","clearfix"],[1,"modal-about"],[1,"font-weight-bold","p-t-5","p-l-10","font-17"],["mat-icon-button","","aria-label","Close dialog",3,"click"],["mat-dialog-content",""],[1,"register-form","m-4",3,"formGroup"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],["appearance","outline",1,"example-full-width","mb-3"],["matInput","","formControlName","schedule_name","readonly",""],["class","row",4,"ngIf"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12"],["style","list-style: none;",4,"ngFor","ngForOf"],[2,"list-style","none"],["color","primary",2,"margin","5px 0 !important",3,"checked","disabled","change"],["aria-labelledby","example-radio-group-label","style","flex-direction: row !important;","class","example-radio-group","style","margin: 5px 0 !important;",4,"ngIf"],[4,"ngIf"],["aria-labelledby","example-radio-group-label",1,"example-radio-group",2,"margin","5px 0 !important"],["class","example-margin","style","padding: 5px;margin-left: 16px;","color","primary",3,"value","checked","change",4,"ngFor","ngForOf"],["color","primary",1,"example-margin",2,"padding","5px","margin-left","16px",3,"value","checked","change"],[2,"padding","5px","margin-left","16px"],[1,"col-xl-10","col-lg-10","col-md-12","col-sm-12"],[1,"example-button-row"],["mat-raised-button","","color","primary",3,"type","click"],["mat-raised-button","","color","warn","tabindex","-1",3,"click"]],template:function(e,t){1&e&&(I.TgZ(0,"div",0),I.TgZ(1,"div",1),I.TgZ(2,"div",2),I.TgZ(3,"div",3),I.TgZ(4,"div",4),I.TgZ(5,"div",5),I._uU(6),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.TgZ(7,"button",6),I.NdJ("click",function(){return t.dialogRef.close()}),I.TgZ(8,"mat-icon"),I._uU(9,"close"),I.qZA(),I.qZA(),I.qZA(),I.TgZ(10,"div",7),I.TgZ(11,"form",8),I.TgZ(12,"div",9),I.TgZ(13,"div",10),I.TgZ(14,"mat-form-field",11),I.TgZ(15,"mat-label"),I._uU(16),I.ALo(17,"translate"),I.qZA(),I._UZ(18,"input",12),I.qZA(),I.qZA(),I.qZA(),I.YNc(19,j,3,1,"div",13),I.YNc(20,B,5,1,"div",13),I.YNc(21,X,5,1,"div",13),I._UZ(22,"br"),I.YNc(23,G,9,7,"div",13),I.qZA(),I.qZA(),I.qZA()),2&e&&(I.xp6(6),I.hij(" Schedule ",t.dialogTitle,""),I.xp6(5),I.Q6J("formGroup",t.calendarForm),I.xp6(5),I.Oqu(I.lcZ(17,7,"SCHEDULE.LIST.SCHEDULE")),I.xp6(3),I.Q6J("ngIf","All"==t.calendar.schedule_view&&4==t.actionData.statusid),I.xp6(1),I.Q6J("ngIf","All"==t.calendar.schedule_view&&4!=t.actionData.statusid),I.xp6(1),I.Q6J("ngIf","All"!=t.calendar.schedule_view),I.xp6(2),I.Q6J("ngIf",4!=t.actionData.statusid))},directives:[f.lW,g.Hw,y.xY,u._Y,u.JL,u.sg,p.KE,p.hX,m.Nt,u.Fj,u.JJ,u.u,s.O5,s.sg,Y.U0,Y.VQ],pipes:[Q.X$],styles:[""]}),e}(),K=function(){function e(t){a(this,e),this.id=t.id||this.getRandomID(),this.lead_time=t.lead_time||"",this.schedule_name=t.schedule_name||"",this.schedule_owner=t.schedule_owner||"",this.schedule_view=t.schedule_view||"",this.schedule_view_assignment=t.schedule_view_assignment||"",this.startDate=(0,s.p6)(new Date,"yyyy-MM-dd","en")||"",this.endDate=(0,s.p6)(new Date,"yyyy-MM-dd","en")||""}return l(e,[{key:"getRandomID",value:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()}}]),e}(),ee=o(60352),te=o(79961),ne=o(87064),ie=o(11757),re=["calendar"];function ae(e,t){if(1&e&&(I.TgZ(0,"mat-option",22),I._uU(1),I.qZA()),2&e){var n=t.$implicit;I.Q6J("value",n),I.xp6(1),I.hij(" ",n.nric_number," ")}}function oe(e,t){if(1&e&&(I.TgZ(0,"div"),I._uU(1),I.qZA()),2&e){var n=I.oxw().$implicit;I.xp6(1),I.hij(" ",n.message," ")}}function le(e,t){if(1&e&&(I.TgZ(0,"mat-error"),I.YNc(1,oe,2,1,"div",23),I.qZA()),2&e){var n=t.$implicit,i=I.oxw();I.xp6(1),I.Q6J("ngIf",i.nric_number.hasError(n.type))}}function se(e,t){if(1&e&&(I.TgZ(0,"mat-option",22),I._uU(1),I.qZA()),2&e){var n=t.$implicit;I.Q6J("value",n),I.xp6(1),I.hij(" ",n.passport_number," ")}}function ue(e,t){if(1&e&&(I.TgZ(0,"div"),I._uU(1),I.qZA()),2&e){var n=I.oxw().$implicit;I.xp6(1),I.hij(" ",n.message," ")}}function ce(e,t){if(1&e&&(I.TgZ(0,"mat-error"),I.YNc(1,ue,2,1,"div",23),I.qZA()),2&e){var n=t.$implicit,i=I.oxw();I.xp6(1),I.Q6J("ngIf",i.passport_number.hasError(n.type))}}function de(e,t){if(1&e&&(I.TgZ(0,"mat-option",22),I._uU(1),I.qZA()),2&e){var n=t.$implicit;I.Q6J("value",n),I.xp6(1),I.hij(" ",n.enrollment_no," ")}}function pe(e,t){if(1&e&&(I.TgZ(0,"div"),I._uU(1),I.qZA()),2&e){var n=I.oxw().$implicit;I.xp6(1),I.hij(" ",n.message," ")}}function me(e,t){if(1&e&&(I.TgZ(0,"mat-error"),I.YNc(1,pe,2,1,"div",23),I.qZA()),2&e){var n=t.$implicit,i=I.oxw(2);I.xp6(1),I.Q6J("ngIf",i.enrollment_no.hasError(n.type))}}function he(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",11),I.TgZ(1,"mat-form-field",12),I.TgZ(2,"mat-label"),I._uU(3),I.ALo(4,"translate"),I.qZA(),I._UZ(5,"input",13),I.TgZ(6,"mat-autocomplete",14,24),I.NdJ("optionSelected",function(e){return I.CHM(n),I.oxw().getStudentSchedulePerEnroll(e)}),I.YNc(8,de,2,2,"mat-option",16),I.ALo(9,"async"),I.qZA(),I.YNc(10,me,2,1,"mat-error",17),I.qZA(),I.qZA()}if(2&e){var i=I.MAs(7),r=I.oxw();I.xp6(3),I.Oqu(I.lcZ(4,6,"SCHEDULE.TRANSACTION-NUMBER")),I.xp6(2),I.Q6J("formControl",r.enrollment_no)("matAutocomplete",i),I.xp6(1),I.Q6J("displayWith",r.displayFnTransactionNumber),I.xp6(2),I.Q6J("ngForOf",I.lcZ(9,8,r.tranNumberList)),I.xp6(2),I.Q6J("ngForOf",r.validation_msgs.enrollment_no)}}function fe(e,t){if(1&e&&(I.TgZ(0,"div",25),I._UZ(1,"div",26),I.TgZ(2,"div",27),I.TgZ(3,"h5",28),I._uU(4,"License Class : "),I.qZA(),I.qZA(),I.TgZ(5,"div",29),I.TgZ(6,"b",30),I._uU(7),I.qZA(),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(7),I.Oqu(n.LicenseData)}}function ge(e,t){if(1&e){var n=I.EpF();I.TgZ(0,"div",8),I.TgZ(1,"p",31),I._uU(2,"Please Make Payment for "),I.TgZ(3,"b"),I._uU(4),I.qZA(),I._uU(5," to proceed further"),I.qZA(),I.TgZ(6,"div",32),I.TgZ(7,"button",33),I.NdJ("click",function(){return I.CHM(n),I.oxw().setPaymentDetails()}),I._uU(8),I.ALo(9,"translate"),I.qZA(),I.qZA(),I.qZA()}if(2&e){var i=I.oxw();I.xp6(4),I.Oqu(i.upcomingStatus.status),I.xp6(3),I.Q6J("type",i.submit),I.xp6(1),I.Oqu(I.lcZ(9,3,"BUTTON.PAYMENT"))}}function ve(e,t){if(1&e&&(I.TgZ(0,"div",8),I.TgZ(1,"div",34),I._UZ(2,"full-calendar",35),I.qZA(),I.qZA()),2&e){var n=I.oxw();I.xp6(2),I.Q6J("options",n.calendarOptions)}}function ye(e,t){1&e&&(I.TgZ(0,"div",8),I.TgZ(1,"div",32),I.TgZ(2,"p"),I._uU(3,"No Schedule Available"),I.qZA(),I.qZA(),I.qZA())}function be(e,t){1&e&&(I.TgZ(0,"div",8),I.TgZ(1,"div",32),I.TgZ(2,"p"),I._uU(3,"Waiting For LDL Status!!. Please Update the LDL Status"),I.qZA(),I.qZA(),I.qZA())}var Ae,Ze=[{path:"schedule-list",component:(Ae=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&e(t,n)}(o,n);var r=t(o);function o(e,t,n,l,s){var c;return a(this,o),(c=r.call(this)).fb=e,c.dialog=t,c.calendarService=n,c.snackBar=l,c.toastrService=s,c.filterOptions="All",c.calendarData=[],c.filterItems=[],c.LicenseData=[],c.showEnroll=!1,c.nric_number=new u.NI("",{validators:[function(e){return"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null}]}),c.passport_number=new u.NI("",{validators:[function(e){return"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null}]}),c.enrollment_no=new u.NI("",{validators:[function(e){return"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null}]}),c.validation_msgs={nric_number:[{type:"invalidAutocompleteObject",message:"NRIC Number not recognized. Click one of the options."}],passport_number:[{type:"invalidAutocompleteObject",message:"Passport Number not recognized. Click one of the options."}],enrollment_no:[{type:"invalidAutocompleteObject",message:"Transaction Number not recognized. Click one of the options."}]},c.calendarOptions={headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:"dayGridMonth",displayEventTime:!1,weekends:!0,editable:!0,selectMirror:!0,dayMaxEvents:!0,eventClick:c.handleEventClick.bind(i(c)),eventsSet:c.handleEvents.bind(i(c))},c.dialogTitle="Add New Event",c.calendar=new K({}),c.addCusForm=c.createCalendarForm(c.calendar),c.getScheduleList(),c}return l(o,[{key:"ngOnInit",value:function(){this.getNRICNumberForStudentSchedule(),this.getPassportNumberForStudentSchedule(),this.loadStripe(),this.getTimeDetails()}},{key:"getNRICNumberForStudentSchedule",value:function(){var e=this;this.calendarService.getNRICNumberForStudentSchedule().subscribe(function(t){e.nricNumberData=t,e.nricNumberList=e.nric_number.valueChanges.pipe((0,q.O)(""),(0,L.U)(function(e){return"string"==typeof e?e:e.nric_number}),(0,L.U)(function(t){return t?e._filterNricNumber(t):e.nricNumberData.slice()}))})}},{key:"getPassportNumberForStudentSchedule",value:function(){var e=this;this.calendarService.getPassportNumberForStudentSchedule().subscribe(function(t){e.passportNumberData=t,e.passportNumberList=e.passport_number.valueChanges.pipe((0,q.O)(""),(0,L.U)(function(e){return"string"==typeof e?e:e.passport_number}),(0,L.U)(function(t){return t?e._filterPassportNumber(t):e.passportNumberData.slice()}))})}},{key:"getScheduleList",value:function(){var e=this;this.calendarService.getScheduleList().subscribe(function(t){e.scheduleList=t.data;for(var n=0;n<e.scheduleList.length;n++)e.scheduleList[n].checked=!0,e.filterItems.push(e.scheduleList[n].status)})}},{key:"displayFnNRICNUmber",value:function(e){return e&&e.nric_number?e.nric_number:""}},{key:"displayFnPassportNumber",value:function(e){return e&&e.passport_number?e.passport_number:""}},{key:"displayFnTransactionNumber",value:function(e){return console.log("user===",e),e&&e.enrollment_no?e.enrollment_no:""}},{key:"_filterNricNumber",value:function(e){var t=e.toLowerCase();return this.nricNumberData.filter(function(e){return e.nric_number.toLowerCase().includes(t)})}},{key:"_filterPassportNumber",value:function(e){var t=e.toLowerCase();return this.passportNumberData.filter(function(e){return e.passport_number.toLowerCase().includes(t)})}},{key:"_filterTranNumber",value:function(e){var t=e.toLowerCase();return this.tranNumberData.filter(function(e){return e.enrollment_no.toLowerCase().includes(t)})}},{key:"changeCategory",value:function(e,t){e.checked?this.filterItems.push(t.status):this.filterItems.splice(this.filterItems.indexOf(t.status),1),this.filterEvent(this.filterItems)}},{key:"filterEvent",value:function(e){var t=this.calendarEvents.filter(function(t){return e.map(function(e){return e}).includes(t.title)});this.calendarOptions.events=t}},{key:"handleEventClick",value:function(e){this.eventClick(e)}},{key:"eventClick",value:function(e){var t,n=this,i={id:e.event.id,title:e.event.title,lead_time:e.event._def.extendedProps.lead_time,statusid:e.event._def.extendedProps.statusid,schedule_name:e.event._def.extendedProps.schedule_name,schedule_view:e.event._def.extendedProps.schedule_view,schedule_view_assignment:e.event._def.extendedProps.employeeName,startDate:e.event.start,endDate:e.event.end,enrollData:this.enrollDetails};t="true"===localStorage.getItem("isRtl")?"rtl":"ltr";var r=this.dialog.open(V,{data:{calendar:i,timeData:this.timeArray,action:"edit"},direction:t});this.subs.sink=r.afterClosed().subscribe(function(e){"submit"===e&&n.addCusForm.reset()})}},{key:"editEvent",value:function(e,t){var n=this.calendarEvents.slice(),i=Object.assign({},n[e]);i.id=t.id,i.title=t.title,i.start=t.startDate,i.end=t.endDate,i.className="",i.groupId=t.category,i.details=t.details,n[e]=i,this.calendarEvents=n,this.calendarOptions.events=n}},{key:"handleEvents",value:function(e){}},{key:"createCalendarForm",value:function(e){return this.fb.group({id:[e.id],lead_time:[e.lead_time,[u.kI.required,u.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],schedule_name:[e.schedule_name],schedule_view:[e.schedule_view],startDate:[e.startDate,[u.kI.required]],endDate:[e.endDate,[u.kI.required]]})}},{key:"showNotification",value:function(e,t,n,i){this.snackBar.open(t,"",{duration:2e3,verticalPosition:n,horizontalPosition:i,panelClass:e})}},{key:"selectedNricNumber",value:function(e){var t=this;this.enrollDetails=[],e.option.value.id&&(this.passport_number.setValue(""),this.calendarService.getEnrollmentNumberForSchedule(e.option.value.id).subscribe(function(e){e.enrollData.length>0?(t.showEnroll=!0,t.tranNumberData=e.enrollData,t.tranNumberList=t.enrollment_no.valueChanges.pipe((0,q.O)(""),(0,L.U)(function(e){return"string"==typeof e?e:e.enrollment_no}),(0,L.U)(function(e){return e?t._filterTranNumber(e):t.tranNumberData.slice()}))):(t.showEnroll=!1,t.toastrService.warning("No Enrollment Number Available"))}))}},{key:"loadStripe",value:function(){var e=this;if(!window.document.getElementById("stripe-script")){var t=window.document.createElement("script");t.id="stripe-script",t.type="text/javascript",t.src="https://checkout.stripe.com/checkout.js",t.onload=function(){e.handler=window.StripeCheckout.configure({key:"pk_test_aeUUjYYcx4XNfKVW60pmHTtI",locale:"auto",token:function(e){console.log(e),alert("Payment Success!!")}})},window.document.body.appendChild(t)}}},{key:"selectedPassportNumber",value:function(e){var t=this;this.enrollDetails=[],e.option.value.id&&(this.nric_number.setValue(""),this.calendarService.getEnrollmentNumberForSchedule(e.option.value.id).subscribe(function(e){e.enrollData.length>0?(t.showEnroll=!0,t.tranNumberData=e.enrollData,t.tranNumberList=t.enrollment_no.valueChanges.pipe((0,q.O)(""),(0,L.U)(function(e){return"string"==typeof e?e:e.enrollment_no}),(0,L.U)(function(e){return e?t._filterTranNumber(e):t.tranNumberData.slice()}))):(t.showEnroll=!1,t.toastrService.warning("No Enrollment Number Available"))}))}},{key:"showSchedule",value:function(e){var t=this;this.calendarService.getStudentSchedulePerEnroll(e).subscribe(function(e){console.log("res============",e),t.calendarData=[],t.enrollDetails=t.enrollment_no.value;for(var n=0;n<e.scheduleList.length;n++)t.calendarData.push({title:e.scheduleList[n].status,start:new Date(e.scheduleList[n].startDate),end:new Date(e.scheduleList[n].endDate),className:e.scheduleList[n].schedule_color,id:e.scheduleList[n].id,statusid:e.scheduleList[n].status_id,schedule_name:e.scheduleList[n].status,schedule_view:e.scheduleList[n].schedule_view,assignment:e.scheduleList[n].AssignmentList,startDate:new Date(e.scheduleList[n].startDate),endDate:new Date(e.scheduleList[n].endDate),employeeName:e.scheduleList[n].employee_name});t.calendarEvents=t.calendarData,t.tempEvents=t.calendarEvents,t.calendarOptions.events=t.calendarEvents})}},{key:"getStudentSchedulePerEnroll",value:function(e){var t=this;this.LicenseData=[],console.log("event.option.value---===========getStudentSchedule==========--",e.option.value),this.calendarService.checkPaymentDone(e.option.value).subscribe(function(n){console.log("res----------",n);var i=n.LicenseData;t.amountToBePaid=n.amountToBePaid,t.upcomingStatus=n.nextStatus[0],console.log("licenseinfo-------------",t.upcomingStatus);for(var r=0;r<i.length;r++)t.LicenseData.push(i[r].license_class);"Success"==n.status?7==t.upcomingStatus.id?t.scheduleStatus="Waiting":(t.scheduleStatus="Success",t.showSchedule(e.option.value)):"Pay"==n.status&&(t.scheduleStatus="Pay")})}},{key:"setPaymentDetails",value:function(){var e=this;console.log("enrollment_no====",this.enrollment_no.value),window.StripeCheckout.configure({key:"pk_test_aeUUjYYcx4XNfKVW60pmHTtI",locale:"auto",token:function(t){e.calendarService.setPaymentDetails(e.enrollment_no.value,e.amountToBePaid).subscribe(function(t){"Success"==t.status?(e.toastrService.success("Payment Done!!"),e.scheduleStatus="Success",e.showSchedule(e.enrollment_no.value)):(e.scheduleStatus="Pay",e.toastrService.success("Payment Failed, Please try again!!"))})}}).open({name:"Demo Site",description:"2 widgets",amount:100*this.amountToBePaid})}},{key:"getTimeDetails",value:function(){var e=this;this.calendarService.getTimeDetails().subscribe(function(t){var n=t.data[0];e.makeTimeIntervals(n.working_hour_from.substr(0,5),n.working_hour_to.substr(0,5),60,n.rest_hour_from.substr(0,5),n.rest_hour_to.substr(0,5))})}},{key:"makeTimeIntervals",value:function(e,t,n,i,r){e=e.toString().split(":"),t=t.toString().split(":"),n=parseInt(n,10);var a=function(e){return e<10?"0"+e.toString():e},o=parseInt(e[0],10),l=parseInt(e[1],10),s=parseInt(t[0],10),u=(parseInt(t[1],10),o),c=l,d=u+":"+a(c),p="",m=[];do{((c+=n)%60==0||c>60)&&(c=60===c?0:c-60,u+=1),p=u+":"+a(c),m.push({range:d+" - "+p,checkValue:0,employeeList:[]}),d=p}while(u!==s);var h=i+" - "+r;this.timeArray=m.filter(function(e){return e.range!=h})}}]),o}(ee.n),Ae.\u0275fac=function(e){return new(e||Ae)(I.Y36(u.qu),I.Y36(y.uw),I.Y36(J),I.Y36(h.ux),I.Y36(R._W))},Ae.\u0275cmp=I.Xpm({type:Ae,selectors:[["app-add-schedule"]],viewQuery:function(e,t){var n;1&e&&I.Gf(re,5),2&e&&I.iGM(n=I.CRH())&&(t.calendar=n.first)},features:[I.qOj],decls:43,vars:29,consts:[[1,"content"],[1,"container-fluid"],[1,"block-header"],[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"breadcrumb","breadcrumb-style"],[1,"breadcrumb-item"],[1,"page-title"],[1,"col-md-12","col-sm-12"],[1,"card"],[1,"card-body"],[1,"col-xl-4","col-lg-4","col-md-12","col-sm-12","mb-2"],["appearance","outline",1,"example-full-width","mb-3"],["type","text","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["autoNric","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["autoPassport","matAutocomplete"],["class","col-xl-4 col-lg-4 col-md-12 col-sm-12 mb-2",4,"ngIf"],["class","row","style","text-align: center;padding: 10px;",4,"ngIf"],["class","col-md-12 col-sm-12",4,"ngIf"],[3,"value"],[4,"ngIf"],["autoTran","matAutocomplete"],[1,"row",2,"text-align","center","padding","10px"],[1,"col-md-2"],[1,"col-md-3"],[2,"float","right"],[1,"col-md-7"],[2,"float","left"],[2,"text-align","center"],[1,"panel-body",2,"text-align","center"],["mat-raised-button","","color","primary",3,"type","click"],[1,"panel-body"],[3,"options"]],template:function(e,t){if(1&e&&(I.TgZ(0,"section",0),I.TgZ(1,"div",1),I.TgZ(2,"div",2),I.TgZ(3,"div",3),I.TgZ(4,"div",4),I.TgZ(5,"ul",5),I.TgZ(6,"li",6),I.TgZ(7,"h4",7),I._uU(8),I.ALo(9,"translate"),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.TgZ(10,"div",3),I.TgZ(11,"div",8),I.TgZ(12,"div",9),I.TgZ(13,"div",10),I.TgZ(14,"div",3),I.TgZ(15,"div",11),I.TgZ(16,"mat-form-field",12),I.TgZ(17,"mat-label"),I._uU(18),I.ALo(19,"translate"),I.qZA(),I._UZ(20,"input",13),I.TgZ(21,"mat-autocomplete",14,15),I.NdJ("optionSelected",function(e){return t.selectedNricNumber(e)}),I.YNc(23,ae,2,2,"mat-option",16),I.ALo(24,"async"),I.qZA(),I.YNc(25,le,2,1,"mat-error",17),I.qZA(),I.qZA(),I.TgZ(26,"div",11),I.TgZ(27,"mat-form-field",12),I.TgZ(28,"mat-label"),I._uU(29),I.ALo(30,"translate"),I.qZA(),I._UZ(31,"input",13),I.TgZ(32,"mat-autocomplete",14,18),I.NdJ("optionSelected",function(e){return t.selectedPassportNumber(e)}),I.YNc(34,se,2,2,"mat-option",16),I.ALo(35,"async"),I.qZA(),I.YNc(36,ce,2,1,"mat-error",17),I.qZA(),I.qZA(),I.YNc(37,he,11,10,"div",19),I.qZA(),I.YNc(38,fe,8,1,"div",20),I.YNc(39,ge,10,5,"div",21),I.YNc(40,ve,3,1,"div",21),I.YNc(41,ye,4,0,"div",21),I.YNc(42,be,4,0,"div",21),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.qZA(),I.qZA()),2&e){var n=I.MAs(22),i=I.MAs(33);I.xp6(8),I.Oqu(I.lcZ(9,19,"SCHEDULE.STUD-TITLE")),I.xp6(10),I.Oqu(I.lcZ(19,21,"SELECT-LICENSE.LIST.NRIC-NUMBER")),I.xp6(2),I.Q6J("formControl",t.nric_number)("matAutocomplete",n),I.xp6(1),I.Q6J("displayWith",t.displayFnNRICNUmber),I.xp6(2),I.Q6J("ngForOf",I.lcZ(24,23,t.nricNumberList)),I.xp6(2),I.Q6J("ngForOf",t.validation_msgs.nric_number),I.xp6(4),I.Oqu(I.lcZ(30,25,"SELECT-LICENSE.LIST.PASSPORT-NUMBER")),I.xp6(2),I.Q6J("formControl",t.passport_number)("matAutocomplete",i),I.xp6(1),I.Q6J("displayWith",t.displayFnPassportNumber),I.xp6(2),I.Q6J("ngForOf",I.lcZ(35,27,t.passportNumberList)),I.xp6(2),I.Q6J("ngForOf",t.validation_msgs.passport_number),I.xp6(1),I.Q6J("ngIf",t.showEnroll),I.xp6(1),I.Q6J("ngIf",t.LicenseData.length>0),I.xp6(1),I.Q6J("ngIf","Pay"==t.scheduleStatus),I.xp6(1),I.Q6J("ngIf",t.calendarData.length>0),I.xp6(1),I.Q6J("ngIf",0==t.calendarData.length&&"Success"==t.scheduleStatus),I.xp6(1),I.Q6J("ngIf",0==t.calendarData.length&&"Waiting"==t.scheduleStatus)}},directives:[p.KE,p.hX,m.Nt,u.Fj,te.ZL,u.JJ,u.oH,te.XC,s.sg,s.O5,ne.ey,p.TO,f.lW,ie.woE],pipes:[Q.X$,s.Ov],styles:[""]}),Ae)}],Se=function(){var e=function e(){a(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=I.oAB({type:e}),e.\u0275inj=I.cJS({imports:[[k.Bz.forChild(Ze)],k.Bz]}),e}(),_e=o(46739),Ne=o(17647),Te=o(95522),we=o(37192),xe=o(279),De=o(9451),ke=o(85256),qe=o(52352);ie.z1U.registerPlugins([xe.ZP,De.ZP,ke.Z,qe.ZP]);var Le,Ue=((Le=function e(){a(this,e)}).\u0275fac=function(e){return new(e||Le)},Le.\u0275mod=I.oAB({type:Le}),Le.\u0275inj=I.cJS({providers:[J],imports:[[Ne.xD,Te.Hi,_e.d,s.ez,u.u5,u.UX,c.p0,d.TU,p.lN,m.c,h.ZX,f.ot,g.Ps,y.Is,b.JX,A.g0,v.LD,Z.FA,S.p9,N.Nh,T.Tx,Y.Fk,_.Ad,Se,w.Cq,x.T5,D.yI,Q.aw,te.Bb,ie.z1U,we.Ll,we.x]]}),Le)}}])}();