!function(){function e(t,i){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,i)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,s=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return i(this,n)}}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return n(e)}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e}(self.webpackChunksmart=self.webpackChunksmart||[]).push([[8791],{28791:function(i,a,r){"use strict";r.r(a),r.d(a,{ScheduleModule:function(){return Se}});var c=r(61116),u=r(31041),d=r(39199),h=r(5609),f=r(13070),p=r(9550),v=r(63589),g=r(84369),m=r(77307),A=r(13841),y=r(92935),Z=r(59241),T=r(37112),w=r(69024),_=r(40994),b=r(1325),k=r(57173),S=r(97070),D=r(87672),x=r(44716),q=r(51601),C=r(35729),I=r(99235),L=r(81258),E=r(91681),U=function(){function e(t){l(this,e),this.id=t.id||this.getRandomID(),this.lead_time=t.lead_time||"",this.schedule_name=t.schedule_name||"",this.schedule_owner=t.schedule_owner||"",this.schedule_view=t.schedule_view||"",this.schedule_view_assignment=t.schedule_view_assignment||"",this.startDate=(0,c.p6)(new Date,"yyyy-MM-dd","en")||"",this.endDate=(0,c.p6)(new Date,"yyyy-MM-dd","en")||""}return o(e,[{key:"getRandomID",value:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()}}]),e}(),N=r(35366),O=function(){var e=function(){function e(t,i){l(this,e),this.data=t,this.dialogRef=i,this.message="",this.confirmButtonText="",this.cancelButtonText="",this.btnColor="primary",this.dynamicMsg="",t&&(this.message=t.message||this.message,this.btnColor=t.btnColor||this.btnColor,this.dynamicMsg=t.dynamicMsg||"",t.buttonText&&(this.confirmButtonText=t.buttonText.ok||this.confirmButtonText,this.cancelButtonText=t.buttonText.cancel||this.cancelButtonText))}return o(e,[{key:"onConfirmClick",value:function(){this.dialogRef.close(!0)}},{key:"onClose",value:function(){this.dialogRef.close(!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(N.Y36(y.WI),N.Y36(y.so))},e.\u0275cmp=N.Xpm({type:e,selectors:[["app-confirmation-dialog"]],decls:10,vars:5,consts:[[2,"text-align","center"],["align","center"],["mat-raised-button","","tabindex","1",3,"color","click"],["mat-raised-button","","mat-dialog-close","","tabindex","-1"]],template:function(e,t){1&e&&(N.TgZ(0,"mat-dialog-content"),N.TgZ(1,"p"),N._uU(2),N.qZA(),N.TgZ(3,"b",0),N._uU(4),N.qZA(),N.qZA(),N.TgZ(5,"mat-dialog-actions",1),N.TgZ(6,"button",2),N.NdJ("click",function(){return t.onConfirmClick()}),N._uU(7),N.qZA(),N.TgZ(8,"button",3),N._uU(9),N.qZA(),N.qZA()),2&e&&(N.xp6(2),N.hij(" ",t.message," "),N.xp6(2),N.Oqu(t.dynamicMsg),N.xp6(2),N.s9C("color",t.btnColor),N.xp6(1),N.Oqu(t.confirmButtonText),N.xp6(2),N.Oqu(t.cancelButtonText))},directives:[y.xY,y.H8,g.lW,y.ZT],styles:[""]}),e}(),F=r(97425),J=r(42693),R=r(89647),M=r(51816),Q=r(529),Y=function(){var e=function(){function e(t){l(this,e),this.http=t,this.API_URL="assets/data/calendar.json",this.httpOptions={headers:new J.WM({"Content-Type":"application/json"})},this.dataChange=new F.X([])}return o(e,[{key:"data",get:function(){return this.dataChange.value}},{key:"getDialogData",value:function(){return this.dialogData}},{key:"getAllCalendars",value:function(){return this.http.get(this.API_URL).pipe((0,M.K)(this.errorHandler))}},{key:"deleteCalendar",value:function(e){this.dialogData=e}},{key:"errorHandler",value:function(e){var t;return t=e.error instanceof ErrorEvent?e.error.message:"Error Code: ".concat(e.status,"\nMessage: ").concat(e.message),console.log(t),(0,R._)(t)}},{key:"getScheduleViewAssignList",value:function(e,t){return this.http.post("".concat(Q.N.apiUrl,"/webRoutes/getScheduleViewAssignList"),{schedule_view:e,license_type:t}).pipe((0,E.U)(function(e){return e}))}},{key:"getScheduleList",value:function(){return this.http.get("".concat(Q.N.apiUrl,"/webRoutes/getScheduleList")).pipe((0,E.U)(function(e){return e}))}},{key:"setScheduleDetails",value:function(e,t,i,n){return this.http.post("".concat(Q.N.apiUrl,"/webRoutes/setScheduleDetails"),{calendarData:e,timeSlot:t,viewAssign_selected:i,license_type:n}).pipe((0,E.U)(function(e){return e}))}},{key:"getScheduleDetails",value:function(){return this.http.get("".concat(Q.N.apiUrl,"/webRoutes/getScheduleDetails")).pipe((0,E.U)(function(e){return e}))}},{key:"updateScheduleDetails",value:function(e,t){return this.http.post("".concat(Q.N.apiUrl,"/webRoutes/updateScheduleDetails"),{calendarData:e,timeslot:t}).pipe((0,E.U)(function(e){return e}))}},{key:"deleteScheduleDetails",value:function(e){return this.http.post("".concat(Q.N.apiUrl,"/webRoutes/deleteScheduleDetails"),{calendarData:e}).pipe((0,E.U)(function(e){return e}))}},{key:"getTimeDetails",value:function(){return this.http.get("".concat(Q.N.apiUrl,"/webRoutes/getTimeDetails")).pipe((0,E.U)(function(e){return e}))}},{key:"getLicenseClassList",value:function(){return this.http.get("".concat(Q.N.apiUrl,"/webRoutes/getLicenseClassList")).pipe((0,E.U)(function(e){return e}))}},{key:"getScheduleEditView",value:function(e){return this.http.post("".concat(Q.N.apiUrl,"/webRoutes/getScheduleEditView"),{editData:e}).pipe((0,E.U)(function(e){return e}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(N.LFG(J.eN))},e.\u0275prov=N.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),V=r(24486),H=r(50518),j=r(31269),P=r(87064),B=r(79961),G=r(95522),z=r(60649),W=["autocompleteTrigger"],$=["licenceInput"];function X(e,t){if(1&e&&(N.TgZ(0,"mat-option",17),N._uU(1),N.qZA()),2&e){var i=t.$implicit;N.Q6J("value",i.id),N.xp6(1),N.hij(" ",i.status," ")}}function K(e,t){if(1&e&&(N.TgZ(0,"mat-option",17),N._uU(1),N.qZA()),2&e){var i=t.$implicit;N.Q6J("value",i),N.xp6(1),N.hij(" ",i.license_class," ")}}function ee(e,t){if(1&e&&(N.TgZ(0,"div"),N._uU(1),N.qZA()),2&e){var i=N.oxw().$implicit;N.xp6(1),N.hij(" ",i.message," ")}}function te(e,t){if(1&e&&(N.TgZ(0,"mat-error"),N.YNc(1,ee,2,1,"div",36),N.qZA()),2&e){var i=t.$implicit,n=N.oxw(2);N.xp6(1),N.Q6J("ngIf",n.license_type.hasError(i.type))}}function ie(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"div",11),N.TgZ(1,"div",12),N.TgZ(2,"mat-form-field",13),N.TgZ(3,"mat-label"),N._uU(4),N.ALo(5,"translate"),N.qZA(),N._UZ(6,"input",32),N.TgZ(7,"mat-autocomplete",33,34),N.NdJ("optionSelected",function(e){return N.CHM(i),N.oxw().selectedLicenseType(e)}),N.YNc(9,K,2,2,"mat-option",15),N.ALo(10,"async"),N.qZA(),N.YNc(11,te,2,1,"mat-error",35),N.qZA(),N.qZA(),N.qZA()}if(2&e){var n=N.MAs(8),a=N.oxw();N.xp6(4),N.Oqu(N.lcZ(5,7,"SCHEDULE.LIST.LICENSE")),N.xp6(2),N.Q6J("formControl",a.license_type)("matAutocomplete",n)("readonly","edit"==a.action),N.xp6(1),N.Q6J("displayWith",a.displayFnLicense),N.xp6(2),N.Q6J("ngForOf",N.lcZ(10,9,a.licenseClassList)),N.xp6(2),N.Q6J("ngForOf",a.validation_msgs.license_type)}}function ne(e,t){1&e&&(N.TgZ(0,"mat-icon",48),N._uU(1,"cancel"),N.qZA())}function ae(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"mat-chip",46),N.NdJ("removed",function(){var e=N.CHM(i).$implicit;return N.oxw(2).remove(e.id)}),N._uU(1),N.YNc(2,ne,2,0,"mat-icon",47),N.qZA()}if(2&e){var n=t.$implicit,a=N.oxw(2);N.Q6J("selectable",a.selectable)("removable",a.removable),N.xp6(1),N.hij(" ",n.name," "),N.xp6(1),N.Q6J("ngIf",a.removable)}}function se(e,t){if(1&e&&(N.TgZ(0,"mat-option",17),N._UZ(1,"mat-checkbox",49),N._uU(2),N.qZA()),2&e){var i=t.$implicit;N.Q6J("value",i.id),N.xp6(1),N.Q6J("checked",i.checked),N.xp6(1),N.hij(" ",i.name," ")}}function re(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"div",11),N.TgZ(1,"div",12),N.TgZ(2,"mat-form-field",13),N.TgZ(3,"mat-chip-list",37,38),N.YNc(5,ae,3,4,"mat-chip",39),N.TgZ(6,"mat-label"),N._uU(7),N.ALo(8,"translate"),N.qZA(),N.TgZ(9,"input",40,41),N.NdJ("matChipInputTokenEnd",function(e){return N.CHM(i),N.oxw().add(e)}),N.qZA(),N.qZA(),N.TgZ(12,"mat-autocomplete",42,43),N.NdJ("optionSelected",function(e){return N.CHM(i),N.oxw().selectedViewAssignment(e)}),N.YNc(14,se,3,3,"mat-option",15),N.ALo(15,"async"),N.qZA(),N.TgZ(16,"button",44),N.NdJ("click",function(){N.CHM(i);var e=N.MAs(11);return N.oxw().openAuto(e)}),N.TgZ(17,"mat-icon",45),N._uU(18,"expand_more"),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA()}if(2&e){var n=N.MAs(4),a=N.MAs(13),s=N.oxw();N.xp6(5),N.Q6J("ngForOf",s.viewAssign_selected),N.xp6(2),N.hij("",N.lcZ(8,7,"SCHEDULE.LIST.ASSIGNMENT"),"*"),N.xp6(2),N.Q6J("matChipInputFor",n)("matChipInputSeparatorKeyCodes",s.separatorKeysCodes)("formControl",s.schedule_view_assignment)("matAutocomplete",a),N.xp6(5),N.Q6J("ngForOf",N.lcZ(15,9,s.viewAssignTypeList))}}function le(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"li",50),N.TgZ(1,"mat-checkbox",51),N.NdJ("change",function(e){var t=N.CHM(i).$implicit;return N.oxw().changeTimeDt(e,t)}),N._uU(2),N.qZA(),N.qZA()}if(2&e){var n=t.$implicit;N.xp6(1),N.Q6J("checked",1==n.checkValue),N.xp6(1),N.hij(" ",n.range," ")}}function ce(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"div",27),N.TgZ(1,"button",52),N.NdJ("click",function(){return N.CHM(i),N.oxw().deleteEvent()}),N.TgZ(2,"mat-icon",53),N._uU(3,"delete"),N.qZA(),N.qZA(),N.qZA()}}var oe=function(){var e=function(){function e(t,i,n,a,s,r,c,o,d){l(this,e),this.dialogRef=t,this.dialog=i,this.data=n,this.calendarService=a,this.modalService=s,this.fb=r,this.toastrService=c,this.spinner=o,this.router=d,this.showDeleteBtn=!1,this.selectable=!0,this.removable=!0,this.separatorKeysCodes=[I.K5,I.OC],this.viewAssign_selected=[],this.license_type=new u.NI("",{validators:[function(e){return"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null},u.kI.required]}),this.schedule_view_assignment=new u.NI("",{validators:[function(e){return"string"==typeof e.value?{invalidAutocompleteObject:{value:e.value}}:null},u.kI.required]}),this.formControl=new u.NI("",[u.kI.required]),this.validation_msgs={license_type:[{type:"invalidAutocompleteObject",message:"License Class not recognized. Click one of the options."}]},this.action=n.action,this.actionData=n,this.timeArray=n.timeData,this.getScheduleList(),this.getLicenseList()}return o(e,[{key:"ngOnInit",value:function(){var e=this;if("edit"===this.action)this.spinner.show(),this.timeSlotList=[],this.viewAssignTypeData=[],this.dialogTitle=this.actionData.calendar.title,this.calendar=this.actionData.calendar,this.showDeleteBtn=!0,this.calendarService.getScheduleEditView(this.actionData.calendar).subscribe(function(t){if("Success"==t.status){e.editInfo=t.data;var i=[];if(e.editInfo.length>0)for(var n=0;n<e.editInfo.length;n++)e.license_type.patchValue({id:e.editInfo[n].license_id,license_class:e.editInfo[n].license_class}),e.editInfo[n].TimeSlot.length<e.timeArray.length?(e.editInfo[n].TimeSlot=e.zeroPad(e.editInfo[n].TimeSlot,e.timeArray.length),i.push(e.editInfo[n].TimeSlot),e.timeSlotList.push(e.editInfo[n].TimeSlot)):(i.push(e.editInfo[n].TimeSlot),e.timeSlotList.push(e.editInfo[n].TimeSlot)),e.viewAssignTypeData.push({id:e.editInfo[n].employee_id,name:e.editInfo[n].employee_name,checked:!0}),e.spinner.hide();for(var a=i.reduce(function(e,t){return e||t}),s=0;s<e.timeArray.length;s++)1==a[s]?(e.timeArray[s].checkValue=1,e.timeArray[s].checked=!0):(e.timeArray[s].checkValue=0,e.timeArray[s].checked=!1);e.viewAssign_selected=e.viewAssignTypeData,e.viewAssignTypeList=e.schedule_view_assignment.valueChanges.pipe((0,L.O)(""),(0,E.U)(function(e){return"string"==typeof e?e:e.name}),(0,E.U)(function(t){return t?e._filterviewAssignType(t):e.viewAssignTypeData.slice()}))}"Session Expired"==t.status&&(e.toastrService.error("Session Expired!!!"),e.router.navigate(["/authentication/signin"]))}),this.calendarForm=this.editContactForm();else{for(var t=0;t<this.timeArray.length;t++)this.timeArray[t].checkValue=1,this.timeArray[t].checked=!0;this.dialogTitle="New Event",this.calendar=new U({}),this.showDeleteBtn=!1,this.calendarForm=this.createContactForm(this.actionData.calendar)}}},{key:"getLicenseList",value:function(){var e=this;this.calendarService.getLicenseClassList().subscribe(function(t){e.licenseClassData=t.data,e.licenseClassList=e.license_type.valueChanges.pipe((0,L.O)(""),(0,E.U)(function(t){return t?e._filterLicenseType(t):e.licenseClassData.slice()}))})}},{key:"getErrorMessage",value:function(){return this.formControl.hasError("required")?"Required field":this.formControl.hasError("email")?"Not a valid email":""}},{key:"displayFnLicense",value:function(e){return e&&e.license_class?e.license_class:""}},{key:"_filterLicenseType",value:function(e){var t=e.toLowerCase();return this.licenseClassData.filter(function(e){return e.license_class.toLowerCase().includes(t)})}},{key:"showScheduleView",value:function(){this.viewAssign_selected=[],this.viewAssignTypeData=[],this.license_type.patchValue("")}},{key:"selectedLicenseType",value:function(e){var t=this;this.viewAssign_selected=[],this.viewAssignTypeData=[],"All"!=this.calendarForm.value.schedule_view&&this.calendarService.getScheduleViewAssignList(this.calendarForm.value.schedule_view,this.license_type.value).subscribe(function(e){t.viewAssignTypeData=e.data,t.viewAssignTypeList=t.schedule_view_assignment.valueChanges.pipe((0,L.O)(""),(0,E.U)(function(e){return"string"==typeof e?e:e.name}),(0,E.U)(function(e){return e?t._filterviewAssignType(e):t.viewAssignTypeData.slice()}))})}},{key:"zeroPad",value:function(e,t){return e.toString().padStart(Number(t),"0")}},{key:"createContactForm",value:function(e){return this.fb.group({id:[this.calendar.id],schedule_name:[this.calendar.schedule_name],schedule_view:[this.calendar.schedule_view],startDate:[e.start,[u.kI.required]],endDate:[e.start,[u.kI.required]]})}},{key:"editContactForm",value:function(){return this.fb.group({id:[this.calendar.id],schedule_name:[this.calendar.schedule_name],schedule_view:[this.calendar.schedule_view],startDate:[this.calendar.startDate,[u.kI.required]],endDate:[this.calendar.endDate,[u.kI.required]]})}},{key:"deleteEvent",value:function(){var e=this;this.dialog.open(O,{data:{message:"Are you sure want to delete the Schedule?",btnColor:"warn",buttonText:{ok:"Yes",cancel:"No"}}}).afterClosed().subscribe(function(t){t&&e.calendarService.deleteScheduleDetails(e.editInfo).subscribe(function(t){e.toastrService.success("Deleted Successfully!!!!"),e.dialogRef.close("delete")})})}},{key:"onNoClick",value:function(){this.dialogRef.close()}},{key:"setScheduleDetails",value:function(){var e=this;if("add"==this.action){for(var t="",i=0,n=0;n<this.timeArray.length;n++)t+=this.timeArray[n].checkValue,1==this.timeArray[n].checkValue&&i++;i>0?"All"==this.calendarForm.value.schedule_view||this.viewAssign_selected.length>0?this.calendarService.setScheduleDetails(this.calendarForm.value,t,this.viewAssign_selected,this.license_type.value).subscribe(function(t){"Success"==t.status?(e.toastrService.success("Updated Successfully!!!!"),e.dialogRef.close("submit")):"Session Expired"==t.status?(e.toastrService.error("Session Expired!!!"),e.router.navigate(["/authentication/signin"])):e.toastrService.error("Already Exists!!!!")}):this.toastrService.error("Please Select the Schedule View Assignment!!"):this.toastrService.error("Please Select the Schedule Time!!")}if("edit"==this.action)if("All"==this.calendarForm.value.schedule_view){for(var a="",s=0;s<this.timeArray.length;s++)a+=this.timeArray[s].checkValue;this.calendarService.updateScheduleDetails(this.editInfo,a).subscribe(function(t){"Success"==t.status&&(e.toastrService.success("Updated Successfully!!!!"),e.dialogRef.close("submit")),"Session Expired"==t.status&&(e.toastrService.error("Session Expired!!!"),e.router.navigate(["/authentication/signin"]))})}else if(this.viewAssign_selected.length>0){for(var r=[],l=[],c=0;c<this.viewAssign_selected.length;c++)r.push(this.viewAssign_selected[c].name),l.push(this.viewAssign_selected[c].id);this.dialog.open(O,{data:{message:"The Schedule will be updated for the selected Instructors",dynamicMsg:r,btnColor:"primary",buttonText:{ok:"OK",cancel:"Cancel"}}}).afterClosed().subscribe(function(t){if(t){for(var i="",n=0;n<e.timeArray.length;n++)i+=e.timeArray[n].checkValue;var a=e.editInfo.filter(function(e){return l.includes(e.employee_id)});e.calendarService.updateScheduleDetails(a,i).subscribe(function(t){"Success"==t.status&&(e.toastrService.success("Updated Successfully!!!!"),e.dialogRef.close("submit")),"Session Expired"==t.status&&(e.toastrService.error("Session Expired!!!"),e.router.navigate(["/authentication/signin"]))})}})}else this.toastrService.error("Please Select the Schedule View Assignment!!")}},{key:"displayFn",value:function(e){return e&&e.name?e.name:""}},{key:"_filterviewAssignType",value:function(e){var t=e.toLowerCase();return this.viewAssignTypeData.filter(function(e){return e.name.toLowerCase().includes(t)})}},{key:"add",value:function(e){var t=e.input,i=e.value;(i||"").trim()&&this.viewAssign_selected.push(i),t&&(t.value=""),this.schedule_view_assignment.setValue("")}},{key:"remove",value:function(e){var t=this,i="";if(this.viewAssign_selected.findIndex(function(t){return t.id===e})>=0)if("edit"==this.action){for(var n=0;n<this.viewAssignTypeData.length;n++)this.viewAssignTypeData[n].id==e&&(i=this.viewAssignTypeData[n].name);this.dialog.open(O,{data:{message:"Are you sure, want to delete the Schedule for the Instructor?",dynamicMsg:i+" schedule will be removed permanently",btnColor:"warn",buttonText:{ok:"Yes",cancel:"No"}}}).afterClosed().subscribe(function(i){if(i){var n=t.editInfo.filter(function(t){return t.employee_id==e});t.calendarService.deleteScheduleDetails(n).subscribe(function(i){if("Success"==i.status){t.toastrService.success("Deleted Successfully!!!!"),t.viewAssign_selected=s(t.viewAssign_selected.filter(function(t){return t.id!==e}));for(var n=0;n<t.viewAssignTypeData.length;n++)t.viewAssignTypeData[n].id==e&&(t.viewAssignTypeData[n].checked=!1);t.dialogRef.close("delete")}"Session Expired"==i.status&&(t.toastrService.error("Session Expired!!!"),t.router.navigate(["/authentication/signin"]))})}})}else{this.viewAssign_selected=s(this.viewAssign_selected.filter(function(t){return t.id!==e}));for(var a=0;a<this.viewAssignTypeData.length;a++)this.viewAssignTypeData[a].id==e&&(i=this.viewAssignTypeData[a].name,this.viewAssignTypeData[a].checked=!1)}}},{key:"openAuto",value:function(e){e.openPanel(),this.licenceInput.nativeElement.focus()}},{key:"selectedViewAssignment",value:function(e){var t=this,i=e.option.viewValue;if(this.viewAssign_selected.findIndex(function(t){return t.id===e.option.value})>=0){this.viewAssign_selected=s(this.viewAssign_selected.filter(function(e){return e.name!==i}));for(var n=0;n<this.viewAssignTypeData.length;n++)this.viewAssignTypeData[n].id==e.option.value&&(this.viewAssignTypeData[n].checked=!1)}else for(var a=0;a<this.viewAssignTypeData.length;a++)this.viewAssignTypeData[a].id==e.option.value&&(this.viewAssignTypeData[a].checked=!0,this.viewAssign_selected.push(this.viewAssignTypeData[a]));if(this.viewAssign_selected.length>1){var r=[];this.timeSlotList=[];for(var l=0;l<this.editInfo.length;l++)for(var c=0;c<this.viewAssign_selected.length;c++)this.editInfo[l].employee_id==this.viewAssign_selected[c].id&&(r.push(this.editInfo[l].TimeSlot),this.timeSlotList.push(this.editInfo[l].TimeSlot));for(var o=r.reduce(function(e,t){return e||t}),u=0;u<this.timeArray.length;u++)1==o[u]?(this.timeArray[u].checkValue=1,this.timeArray[u].checked=!0):(this.timeArray[u].checkValue=0,this.timeArray[u].checked=!1)}else if(1==this.viewAssign_selected.length){for(var d,h=0;h<this.editInfo.length;h++)this.editInfo[h].employee_id==this.viewAssign_selected[0].id&&(d=this.editInfo[h].TimeSlot);for(var f=0;f<this.timeArray.length;f++)1==d[f]?(this.timeArray[f].checkValue=1,this.timeArray[f].checked=!0):(this.timeArray[f].checkValue=0,this.timeArray[f].checked=!1)}else for(var p=0;p<this.timeArray.length;p++)this.timeArray[p].checkValue=0,this.timeArray[p].checked=!1;this.licenceInput.nativeElement.value="",this.schedule_view_assignment.setValue(""),requestAnimationFrame(function(){t.openAuto(t.matACTrigger)})}},{key:"getScheduleList",value:function(){var e=this;this.calendarService.getScheduleList().subscribe(function(t){e.scheduleList=t.data})}},{key:"changeTimeDt",value:function(e,t){if(1==e.checked)for(var i=0;i<this.timeArray.length;i++)this.timeArray[i].range==t.range&&(this.timeArray[i].checkValue=1);else for(var n=0;n<this.timeArray.length;n++)this.timeArray[n].range==t.range&&(this.timeArray[n].checkValue=0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(N.Y36(y.so),N.Y36(y.uw),N.Y36(y.WI),N.Y36(Y),N.Y36(V.FF),N.Y36(u.qu),N.Y36(H._W),N.Y36(j.t2),N.Y36(C.F0))},e.\u0275cmp=N.Xpm({type:e,selectors:[["app-form-dialog"]],viewQuery:function(e,t){var i;(1&e&&(N.Gf(W,5),N.Gf($,5)),2&e)&&(N.iGM(i=N.CRH())&&(t.matACTrigger=i.first),N.iGM(i=N.CRH())&&(t.licenceInput=i.first))},decls:75,vars:40,consts:[["bdColor","rgba(51,51,51,0.8)","size","medium","color","#fff","type","ball-scale-multiple"],[2,"font-size","20px","color","white"],[1,"addContainer"],[1,"modalHeader"],[1,"editRowModal"],[1,"modalHeader","clearfix"],[1,"modal-about"],[1,"font-weight-bold","p-t-5","p-l-10","font-17"],["mat-icon-button","","aria-label","Close dialog",3,"click"],["mat-dialog-content",""],[1,"register-form","m-4",3,"formGroup"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],["appearance","outline",1,"example-full-width","mb-3"],["formControlName","schedule_name","required","",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["formControlName","schedule_view","required","",3,"disabled","selectionChange"],[3,"value"],["class","row",4,"ngIf"],[1,"col-xl-6","col-lg-6","col-md-12","col-sm-12"],["matInput","","formControlName","startDate",3,"matDatepicker","disabled"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","endDate",3,"matDatepicker","disabled"],["picker1",""],["style","list-style: none;",4,"ngFor","ngForOf"],[1,"col-xl-10","col-lg-10","col-md-12","col-sm-12"],[1,"example-button-row"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","warn","tabindex","-1",3,"click"],[1,"col-xl-2","col-lg-2","col-md-12","col-sm-12"],["class","example-button-row",4,"ngIf"],["type","text","matInput","",3,"formControl","matAutocomplete","readonly"],[3,"displayWith","optionSelected"],["autoNric","matAutocomplete"],[4,"ngFor","ngForOf"],[4,"ngIf"],["aria-label","Fruit selection"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["type","text","matInput","",3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete","matChipInputTokenEnd"],["licenceInput","","autocompleteTrigger","matAutocompleteTrigger"],["autoActiveFirstOption","",3,"optionSelected"],["autoView","matAutocomplete"],["mat-icon-button","","matSuffix","",2,"width","34px","height","34px",3,"click"],[2,"width","34px"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],["color","primary",2,"padding","0 12px",3,"checked"],[2,"list-style","none"],["color","primary",3,"checked","change"],["mat-mini-fab","","aria-label","","color","warn",3,"click"],[1,"font-20"]],template:function(e,t){if(1&e&&(N.TgZ(0,"ngx-spinner",0),N.TgZ(1,"p",1),N._uU(2,"Loading..."),N.qZA(),N.qZA(),N.TgZ(3,"div",2),N.TgZ(4,"div",3),N.TgZ(5,"div",4),N.TgZ(6,"div",5),N.TgZ(7,"div",6),N.TgZ(8,"div",7),N._uU(9),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.TgZ(10,"button",8),N.NdJ("click",function(){return t.dialogRef.close()}),N.TgZ(11,"mat-icon"),N._uU(12,"close"),N.qZA(),N.qZA(),N.qZA(),N.TgZ(13,"div",9),N.TgZ(14,"form",10),N.TgZ(15,"div",11),N.TgZ(16,"div",12),N.TgZ(17,"mat-form-field",13),N.TgZ(18,"mat-label"),N._uU(19),N.ALo(20,"translate"),N.qZA(),N.TgZ(21,"mat-select",14),N.YNc(22,X,2,2,"mat-option",15),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.TgZ(23,"div",11),N.TgZ(24,"div",12),N.TgZ(25,"mat-form-field",13),N.TgZ(26,"mat-label"),N._uU(27),N.ALo(28,"translate"),N.qZA(),N.TgZ(29,"mat-select",16),N.NdJ("selectionChange",function(){return t.showScheduleView()}),N.TgZ(30,"mat-option",17),N._uU(31," Driving Institute "),N.qZA(),N.TgZ(32,"mat-option",17),N._uU(33," Instructor "),N.qZA(),N.TgZ(34,"mat-option",17),N._uU(35," QTI "),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.YNc(36,ie,12,11,"div",18),N.YNc(37,re,19,11,"div",18),N.TgZ(38,"div",11),N.TgZ(39,"div",19),N.TgZ(40,"mat-form-field",13),N.TgZ(41,"mat-label"),N._uU(42),N.ALo(43,"translate"),N.qZA(),N._UZ(44,"input",20),N._UZ(45,"mat-datepicker-toggle",21),N._UZ(46,"mat-datepicker",null,22),N.qZA(),N.qZA(),N.TgZ(48,"div",19),N.TgZ(49,"mat-form-field",13),N.TgZ(50,"mat-label"),N._uU(51),N.ALo(52,"translate"),N.qZA(),N._UZ(53,"input",23),N._UZ(54,"mat-datepicker-toggle",21),N._UZ(55,"mat-datepicker",null,24),N.qZA(),N.qZA(),N.qZA(),N.TgZ(57,"div",11),N.TgZ(58,"label"),N._uU(59),N.ALo(60,"translate"),N.qZA(),N.TgZ(61,"div",19),N.YNc(62,le,3,2,"li",25),N.qZA(),N.qZA(),N._UZ(63,"br"),N.TgZ(64,"div",11),N.TgZ(65,"div",26),N.TgZ(66,"div",27),N.TgZ(67,"button",28),N.NdJ("click",function(){return t.setScheduleDetails()}),N._uU(68),N.ALo(69,"translate"),N.qZA(),N.TgZ(70,"button",29),N.NdJ("click",function(){return t.dialogRef.close()}),N._uU(71),N.ALo(72,"translate"),N.qZA(),N.qZA(),N.qZA(),N.TgZ(73,"div",30),N.YNc(74,ce,4,0,"div",31),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA()),2&e){var i=N.MAs(47),n=N.MAs(56);N.xp6(9),N.hij(" ",t.dialogTitle,""),N.xp6(5),N.Q6J("formGroup",t.calendarForm),N.xp6(5),N.Oqu(N.lcZ(20,26,"SCHEDULE.LIST.SCHEDULE")),N.xp6(2),N.Q6J("disabled","edit"==t.action),N.xp6(1),N.Q6J("ngForOf",t.scheduleList),N.xp6(5),N.Oqu(N.lcZ(28,28,"SCHEDULE.LIST.SCHEDULE-VIEW")),N.xp6(2),N.Q6J("disabled","edit"==t.action),N.xp6(1),N.Q6J("value","All"),N.xp6(2),N.Q6J("value","Instructor"),N.xp6(2),N.Q6J("value","QTI"),N.xp6(2),N.Q6J("ngIf",""!=t.calendarForm.value.schedule_view),N.xp6(1),N.Q6J("ngIf",""!=t.calendarForm.value.schedule_view&&"All"!=t.calendarForm.value.schedule_view&&""!=t.license_type.value),N.xp6(5),N.Oqu(N.lcZ(43,30,"SCHEDULE.LIST.START-DATE")),N.xp6(2),N.Q6J("matDatepicker",i)("disabled","edit"==t.action),N.xp6(1),N.Q6J("for",i),N.xp6(6),N.Oqu(N.lcZ(52,32,"SCHEDULE.LIST.END-DATE")),N.xp6(2),N.Q6J("matDatepicker",n)("disabled","edit"==t.action),N.xp6(1),N.Q6J("for",n),N.xp6(5),N.Oqu(N.lcZ(60,34,"SCHEDULE.LIST.SCHEDULE-TIME")),N.xp6(3),N.Q6J("ngForOf",t.timeArray),N.xp6(5),N.Q6J("disabled",!t.calendarForm.valid||!t.license_type.valid),N.xp6(1),N.Oqu(N.lcZ(69,36,"BUTTON.ADD-BTN")),N.xp6(3),N.Oqu(N.lcZ(72,38,"BUTTON.CANCEL-BTN")),N.xp6(3),N.Q6J("ngIf",t.showDeleteBtn)}},directives:[j.Ro,g.lW,m.Hw,y.xY,u._Y,u.JL,u.sg,f.KE,f.hX,A.gD,u.JJ,u.u,u.Q7,c.sg,P.ey,c.O5,p.Nt,u.Fj,w.hl,w.nW,f.R9,w.Mq,B.ZL,u.oH,B.XC,f.TO,G.qn,G.oH,G.HS,G.qH,_.oG],pipes:[z.X$,c.Ov],styles:[""]}),e}(),ue=r(60352),de=r(2867),he=r(11757),fe=["calendar"];function pe(e,t){if(1&e){var i=N.EpF();N.TgZ(0,"li"),N.TgZ(1,"mat-checkbox",16),N.NdJ("change",function(e){var t=N.CHM(i).$implicit;return N.oxw().changeCategory(e,t)}),N._uU(2),N.qZA(),N.qZA()}if(2&e){var n=t.$implicit;N.xp6(1),N.Q6J("checked",n.checked)("value",n.status),N.xp6(1),N.hij(" ",n.status," ")}}var ve,ge=[{path:"schedule-list",component:(ve=function(i){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&e(t,i)}(s,i);var a=t(s);function s(e,t,i,r,c,o,u,d){var h;return l(this,s),(h=a.call(this)).fb=e,h.dialog=t,h.calendarService=i,h.snackBar=r,h.spinner=c,h.router=o,h.toastrService=u,h.deviceService=d,h.filterOptions="All",h.calendarData=[],h.filterItems=[],h.checkAll=!0,h.calendarOptions={headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:h.deviceService.isDesktop()?"dayGridMonth":"listWeek",displayEventTime:!1,weekends:!0,editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,select:h.handleDateSelect.bind(n(h)),eventClick:h.handleEventClick.bind(n(h)),eventsSet:h.handleEvents.bind(n(h))},h.dialogTitle="Add New Event",h.calendar=new U({}),h.addCusForm=h.createCalendarForm(h.calendar),h.getScheduleList(),h.getTimeDetails(),h}return o(s,[{key:"ngOnInit",value:function(){this.getScheduleDetails()}},{key:"getScheduleDetails",value:function(){var e=this;this.calendarData=[],this.calendarService.getScheduleDetails().subscribe(function(t){if("Success"==t.status){for(var i=0;i<t.data.length;i++)e.calendarData.push({title:t.data[i].status+" - "+t.data[i].license_class,start:new Date(t.data[i].startDate),end:new Date(t.data[i].endDate),className:t.data[i].schedule_color,id:t.data[i].id,lead_time:t.data[i].lead_time,schedule_name:t.data[i].status_id,schedule_view:t.data[i].schedule_view,assignment:t.data[i].AssignmentList,startDate:new Date(t.data[i].startDate),endDate:new Date(t.data[i].endDate),license_id:t.data[i].license_id});e.calendarEvents=e.calendarData,e.tempEvents=e.calendarEvents,e.calendarOptions.events=e.calendarEvents}"Session Expired"==t.status&&(e.toastrService.error("Session Expired!!!"),e.router.navigate(["/authentication/signin"]))})}},{key:"getScheduleList",value:function(){var e=this;this.calendarService.getScheduleList().subscribe(function(t){e.scheduleList=t.data;for(var i=0;i<e.scheduleList.length;i++)e.scheduleList[i].checked=!0,e.filterItems.push(e.scheduleList[i].status)})}},{key:"handleDateSelect",value:function(e){this.addNewEvent(e)}},{key:"addNewEvent",value:function(e){var t=this,i=this.dialog.open(oe,{data:{calendar:e,timeData:this.timeArray,action:"add"}});this.subs.sink=i.afterClosed().subscribe(function(e){"submit"===e&&t.getScheduleDetails()})}},{key:"changeCategory",value:function(e,t){e.checked?this.filterItems.push(t.status):this.filterItems.splice(this.filterItems.indexOf(t.status),1),this.filterEvent(this.filterItems)}},{key:"changeAll",value:function(e){if(1==e.checked){this.checkAll=!0;for(var t=0;t<this.scheduleList.length;t++)this.scheduleList[t].checked=!0,this.filterItems.push(this.scheduleList[t].status);this.filterEvent(this.filterItems)}else{this.checkAll=!1;for(var i=0;i<this.scheduleList.length;i++)this.scheduleList[i].checked=!1;this.filterItems=[],this.filterEvent(this.filterItems)}}},{key:"filterEvent",value:function(e){var t=this.calendarEvents.filter(function(t){return e.map(function(e){return e}).includes(t.title.split(" - ")[0])});this.calendarOptions.events=t}},{key:"handleEventClick",value:function(e){this.eventClick(e)}},{key:"eventClick",value:function(e){var t,i=this,n={id:e.event.id,title:e.event.title,lead_time:e.event._def.extendedProps.lead_time,schedule_name:e.event._def.extendedProps.schedule_name,schedule_view:e.event._def.extendedProps.schedule_view,schedule_view_assignment:e.event._def.extendedProps.assignment,startDate:e.event._def.extendedProps.startDate,endDate:e.event._def.extendedProps.endDate,license_id:e.event._def.extendedProps.license_id};t="true"===localStorage.getItem("isRtl")?"rtl":"ltr";var a=this.dialog.open(oe,{data:{calendar:n,timeData:this.timeArray,action:"edit"},direction:t});this.subs.sink=a.afterClosed().subscribe(function(e){"submit"===e?(i.getScheduleDetails(),i.addCusForm.reset()):"delete"===e&&i.getScheduleDetails()})}},{key:"editEvent",value:function(e,t){var i=this.calendarEvents.slice(),n=Object.assign({},i[e]);n.id=t.id,n.title=t.title,n.start=t.startDate,n.end=t.endDate,n.className="",n.groupId=t.category,n.details=t.details,i[e]=n,this.calendarEvents=i,this.calendarOptions.events=i}},{key:"handleEvents",value:function(e){}},{key:"createCalendarForm",value:function(e){return this.fb.group({id:[e.id],lead_time:[e.lead_time,[u.kI.required,u.kI.pattern("[a-zA-Z]+([a-zA-Z ]+)*")]],schedule_name:[e.schedule_name],schedule_view:[e.schedule_view],startDate:[e.startDate,[u.kI.required]],endDate:[e.endDate,[u.kI.required]]})}},{key:"getTimeDetails",value:function(){var e=this;this.calendarService.getTimeDetails().subscribe(function(t){var i=t.data[0];e.makeTimeIntervals(i.working_hour_from.substr(0,5),i.working_hour_to.substr(0,5),60,i.rest_hour_from.substr(0,5),i.rest_hour_to.substr(0,5))})}},{key:"makeTimeIntervals",value:function(e,t,i,n,a){e=e.toString().split(":"),t=t.toString().split(":"),i=parseInt(i,10);var s=function(e){return e<10?"0"+e.toString():e},r=parseInt(e[0],10),l=parseInt(e[1],10),c=parseInt(t[0],10),o=(parseInt(t[1],10),r),u=l,d=o+":"+s(u),h="",f=[];do{((u+=i)%60==0||u>60)&&(u=60===u?0:u-60,o+=1),h=o+":"+s(u),f.push({range:d+" - "+h,checked:!1,checkValue:0}),d=h}while(o!==c);var p=n+" - "+a;this.timeArray=f.filter(function(e){return e.range!=p})}}]),s}(ue.n),ve.\u0275fac=function(e){return new(e||ve)(N.Y36(u.qu),N.Y36(y.uw),N.Y36(Y),N.Y36(v.ux),N.Y36(j.t2),N.Y36(C.F0),N.Y36(H._W),N.Y36(de.x0))},ve.\u0275cmp=N.Xpm({type:ve,selectors:[["app-add-schedule"]],viewQuery:function(e,t){var i;1&e&&N.Gf(fe,5),2&e&&N.iGM(i=N.CRH())&&(t.calendar=i.first)},features:[N.qOj],decls:30,vars:7,consts:[["bdColor","rgba(51,51,51,0.8)","size","medium","color","#fff","type","ball-scale-multiple"],[2,"font-size","20px","color","white"],[1,"content"],[1,"container-fluid"],[1,"block-header"],[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"breadcrumb","breadcrumb-style"],[1,"breadcrumb-item"],[1,"page-title"],[1,"col-md-12","col-sm-12"],[1,"card"],[1,"card-body"],[1,"col-md-2","col-sm-12","p-l-30"],[1,"m-b-25"],[1,"filter-container"],["color","primary",3,"checked","value","change"],[4,"ngFor","ngForOf"],[1,"col-md-10","col-sm-12"],[1,"panel-body"],[3,"options"]],template:function(e,t){1&e&&(N.TgZ(0,"ngx-spinner",0),N.TgZ(1,"p",1),N._uU(2,"Loading..."),N.qZA(),N.qZA(),N.TgZ(3,"section",2),N.TgZ(4,"div",3),N.TgZ(5,"div",4),N.TgZ(6,"div",5),N.TgZ(7,"div",6),N.TgZ(8,"ul",7),N.TgZ(9,"li",8),N.TgZ(10,"h4",9),N._uU(11),N.ALo(12,"translate"),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.TgZ(13,"div",5),N.TgZ(14,"div",10),N.TgZ(15,"div",11),N.TgZ(16,"div",12),N.TgZ(17,"div",5),N.TgZ(18,"div",13),N._UZ(19,"div",14),N.TgZ(20,"div",15),N.TgZ(21,"ul"),N.TgZ(22,"li"),N.TgZ(23,"mat-checkbox",16),N.NdJ("change",function(e){return t.changeAll(e)}),N._uU(24," Select All"),N.qZA(),N.qZA(),N._UZ(25,"br"),N.YNc(26,pe,3,3,"li",17),N.qZA(),N.qZA(),N.qZA(),N.TgZ(27,"div",18),N.TgZ(28,"div",19),N._UZ(29,"full-calendar",20),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA(),N.qZA()),2&e&&(N.xp6(11),N.Oqu(N.lcZ(12,5,"SCHEDULE.TITLE")),N.xp6(12),N.Q6J("checked",t.checkAll)("value",t.checkAll),N.xp6(3),N.Q6J("ngForOf",t.scheduleList),N.xp6(3),N.Q6J("options",t.calendarOptions))},directives:[j.Ro,_.oG,c.sg,he.woE],pipes:[z.X$],styles:[""]}),ve)}],me=function(){var e=function e(){l(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=N.oAB({type:e}),e.\u0275inj=N.cJS({imports:[[C.Bz.forChild(ge)],C.Bz]}),e}(),Ae=r(46739),ye=r(17647),Ze=r(37192),Te=r(279),we=r(9451),_e=r(85256),be=r(52352);he.z1U.registerPlugins([Te.ZP,we.ZP,_e.Z,be.ZP]);var ke,Se=((ke=function e(){l(this,e)}).\u0275fac=function(e){return new(e||ke)},ke.\u0275mod=N.oAB({type:ke}),ke.\u0275inj=N.cJS({providers:[Y],imports:[[ye.xD,G.Hi,Ae.d,c.ez,u.u5,u.UX,d.p0,h.TU,f.lN,p.c,v.ZX,g.ot,m.Ps,y.Is,Z.JX,T.g0,A.LD,w.FA,_.p9,k.Nh,S.Tx,b.Ad,me,D.Cq,x.T5,j.ef,q.yI,z.aw,B.Bb,he.z1U,Ze.Ll,Ze.x]]}),ke)}}])}();